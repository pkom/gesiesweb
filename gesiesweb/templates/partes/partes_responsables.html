{% extends 'base.html' %}

{% load staticfiles %}
{% load thumbnail %}

{% block extra_css %}
<style>
    #partes-responsable>tbody>tr>td { vertical-align: middle; }
</style>
{% endblock extra_css %}


{% block breadcrumbs %}
  <!-- #section:basics/content.breadcrumbs -->
  <div class="breadcrumbs" id="breadcrumbs">
    <script type="text/javascript">
      try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
    </script>

    <ul class="breadcrumb">
      <li>
        <i class="ace-icon fa fa-bullhorn home-icon"></i>
        <a href="{% url 'parte:partes-responsable' %}">Partes del centro</a>
      </li>
      <li class="active">Partes del centro</li>
    </ul><!-- /.breadcrumb -->

    <!-- #section:basics/content.searchbox -->
    <div class="nav-search" id="nav-search">
      <form class="form-search">
        <span class="input-icon">
          <input type="text" placeholder="Buscar ..." class="nav-search-input" id="nav-search-input" autocomplete="off" />
          <i class="ace-icon fa fa-search nav-search-icon"></i>
        </span>
      </form>
    </div><!-- /.nav-search -->

    <!-- /section:basics/content.searchbox -->
  </div>
  <!-- /section:basics/content.breadcrumbs -->
{% endblock breadcrumbs %}



{% block pageheader %}
  <div class="page-header">
    <h1>
      Partes del Centro
      <small>
        <i class="ace-icon fa fa-angle-double-right"></i>
        Partes del Centro
      </small>
    </h1>
  </div><!-- /.page-header -->
{% endblock pageheader %}


{% block contenido %}
    <div class="table-header">
      <span class="badge badge-success">{{ total_partes }}</span>
      <span> Partes del centro</span>
      <span class="badge badge-important">Partes {{ total_partes_partes }}</span>
      <span class="badge badge-important">Comunicados {{ total_partes_comunicados }}</span>
      <span class="badge badge-important">Cerrados {{ total_partes_cerrados }}</span>
    </div>

    <div tabindex="-1" class="modal fade" id="info-parte">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header no-padding">
                    <div class="table-header">
                        <button aria-hidden="true" data-dismiss="modal" class="close" type="button">
                            <span class="white">Ã—</span>
                        </button>
                        Results for "Latest Registered Domains
                    </div>
                </div>

                <div class="modal-body no-padding">
                    <table class="table table-striped table-bordered table-hover no-margin-bottom no-border-top">
                        <thead>
                            <tr>
                                <th>Domain</th>
                                <th>Price</th>
                                <th>Clicks</th>

                                <th>
                                    <i class="ace-icon fa fa-clock-o bigger-110"></i>
                                    Update
                                </th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr>
                                <td>
                                    <a href="#">ace.com</a>
                                </td>
                                <td>$45</td>
                                <td>3,330</td>
                                <td>Feb 12</td>
                            </tr>

                            <tr>
                                <td>
                                    <a href="#">base.com</a>
                                </td>
                                <td>$35</td>
                                <td>2,595</td>
                                <td>Feb 18</td>
                            </tr>

                            <tr>
                                <td>
                                    <a href="#">max.com</a>
                                </td>
                                <td>$60</td>
                                <td>4,400</td>
                                <td>Mar 11</td>
                            </tr>

                            <tr>
                                <td>
                                    <a href="#">best.com</a>
                                </td>
                                <td>$75</td>
                                <td>6,500</td>
                                <td>Apr 03</td>
                            </tr>

                            <tr>
                                <td>
                                    <a href="#">pro.com</a>
                                </td>
                                <td>$55</td>
                                <td>4,250</td>
                                <td>Jan 21</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="modal-footer no-margin-top">
                    <button data-dismiss="modal" class="btn btn-sm btn-danger pull-left">
                        <i class="ace-icon fa fa-times"></i>
                        Close
                    </button>

                    <ul class="pagination pull-right no-margin">
                        <li class="prev disabled">
                            <a href="#">
                                <i class="ace-icon fa fa-angle-double-left"></i>
                            </a>
                        </li>

                        <li class="active">
                            <a href="#">1</a>
                        </li>

                        <li>
                            <a href="#">2</a>
                        </li>

                        <li>
                            <a href="#">3</a>
                        </li>

                        <li class="next">
                            <a href="#">
                                <i class="ace-icon fa fa-angle-double-right"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>


    <table id="partes-responsable" class="table table-striped table-bordered table-hover dataTable" aria-describedby="partes-responsable_info">
        <thead>
            <tr role="row">
                <th class="hidden-sm hidden-xs sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Id: activate to sort column ascending">Id</th>
                <th class="sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Fecha: activate to sort column ascending">Fecha</th>
                <th class="sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Grupo: activate to sort column ascending">Grupo</th>
                <th class="align-center hidden sorting_disabled" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Foto Alumno: activate to sort column ascending">FotoA</th>
                <th class="sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Alumno: activate to sort column ascending">Alumn@</th>
                <th class="align-center hidden sorting_disabled" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Foto Profesor: activate to sort column ascending">FotoP</th>
                <th class="sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Profesor: activate to sort column ascending">Profesor/a</th>
                <th class="hidden-sm hidden-xs sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Parte: activate to sort column ascending">Parte</th>
                <th class="hidden-sm hidden-xs sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Comunicado: activate to sort column ascending">Comun.</th>
                <th class="hidden-sm hidden-xs sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Cerrado: activate to sort column ascending">Cerrado</th>
                <th class="sorting_disabled align-center" role="columnheader" rowspan="1" colspan="1" aria-label="">Acciones</th>
            </tr>
        </thead>
    </table>

{% endblock contenido %}

{% block extra_js_links %}
		<script src="{% static 'js/jquery.dataTables.min.js' %}"></script>
		<script src="{% static 'js/jquery.dataTables.bootstrap.min.js' %}"></script>
{% endblock extra_js_links %}

{% block extra_js %}
    <script type="text/javascript">
        jQuery(function($) {

            var oPartesResponsable =
            $('#partes-responsable').dataTable({
                "lengthMenu": [[ 5, 10, 15, -1 ], [ 5, 10, 15, "Todos" ]],
                "processing": true,
                "serverSide": true,
                "ajax": "{% url 'parte:partes_responsable_json' %}",
                "language": {
                    "url": "{% static 'js/dataTables.spanish.lang' %}"
                },
                "order": [[ 1, "desc" ], [ 0, "desc" ]],
                bAutoWidth: false,
                "columns": [
                    { "data": {
                        "_": "id.id",
                        "display": "id.display"
                        }
                    },
                    { "data": "fecha" },
                    { "data": "grupo" },
                    { "data": "fotoalu" },
                    { "data": "alumno" },
                    { "data": "fotoprofe" },
                    { "data": "profesor" },
                    { "data": "con_parte" },
                    { "data": "comunicado" },
                    { "data": "cerrado" }
                ],
                "columnDefs": [
                    { "searchable": false, "targets": [ 0, 3, 5, 7, 8, 9, 10] },
                    { "orderable": false, "targets": [ 3, 5, 10] },
                    { className: "hidden-sm hidden-xs align-right", "targets": [ 0 ] },
                    { className: "align-center", "targets": [ 1, 2, 10 ] },
                    { className: "hidden-sm hidden-xs align-center", "targets": [ 7, 8, 9 ] },
                    {
                        "targets": 0,
                        "render": function( data, type, row ) {
                            return '<a href="' + data + '">' + row.id.id + '</a>';
                        }
                    },
                    {
                        "targets": 4,
                        "render": function ( data, type, row ) {
                            return '<img class="nav-user-foto" style="border-radius: 15px;"' +
                                    'src="' + row.fotoalu + '"/>'+data;
                        }
                    },
                    {
                        "targets": 6,
                        "render": function ( data, type, row ) {
                            return '<img class="nav-user-foto" style="border-radius: 15px;"' +
                                    'src="' + row.fotoprofe + '"/>'+data;
                        }
                    },
                    {
                        "targets": 7,
                        "render": function ( data, type, row ) {
                            if (data) {
                                return '<input type="checkbox" checked="checked"/>'
                            }
                            else
                                return '<input type="checkbox"/>'
                        }
                    },
                    {
                        "targets": 8,
                        "render": function ( data, type, row ) {
                            if (data) {
                                return '<input type="checkbox" checked="checked"/>'
                            }
                            else
                                return '<input type="checkbox"/>'
                        }
                    },
                    {
                        "targets": 9,
                        "render": function ( data, type, row ) {
                            if (data) {
                                return '<input type="checkbox" checked="checked"/>'
                            }
                            else
                                return '<input type="checkbox"/>'
                        }
                    },
                    {
                        "targets": 10,
                        "class":          "details-control",
                        "orderable":      false,
                        "data":           null,
                        "render": function ( data, type, row ) {
                            return  '<div class="hidden-sm hidden-xs action-buttons">' +
                                        '<a class="blue tooltip-info" href="#info-parte" data-rel="tooltip" ' +
                                            'data-toggle="modal" title="" data-original-title="Ver">' +
                                                '<i class="ace-icon fa fa-search-plus bigger-130"></i>' +
                                        '</a>' +
                                        '<a class="green tooltip-success" href="' + row.urls.editar + '" ' +
                                            'data-rel="tooltip" title="" data-original-title="Edita">' +
                                                '<i class="ace-icon fa fa-pencil bigger-130"></i>' +
                                        '</a>' +
                                        '<a class="red tooltip-error" href="' + row.urls.eliminar + '" ' +
                                            'data-rel="tooltip" title="" data-original-title="Elimina">' +
                                                '<i class="ace-icon fa fa-trash-o bigger-130"></i>' +
                                        '</a>' +
                                    '</div>' +
                                    '<div class="hidden-md hidden-lg">' +
                                        '<div class="inline position-relative">' +
                                            '<button class="btn btn-minier btn-yellow dropdown-toggle" data-toggle="dropdown" data-position="auto">' +
                                                '<i class="ace-icon fa fa-caret-down icon-only bigger-120"></i>' +
                                            '</button>' +
                                            '<ul class="dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close">' +
                                                '<li>' +
                                                    '<a href="'+row.urls.detalle+'" class="tooltip-info" data-rel="tooltip" title="" data-original-title="Ver">' +
                                                        '<span class="blue">' +
                                                            '<i class="ace-icon fa fa-search-plus bigger-120"></i>' +
                                                        '</span>' +
                                                    '</a>' +
                                                '</li>' +
                                                '<li>' +
                                                    '<a href="'+row.urls.editar+'" class="tooltip-success" data-rel="tooltip" title="" data-original-title="Edita">' +
                                                        '<span class="green">' +
                                                            '<i class="ace-icon fa fa-pencil-square-o bigger-120"></i>' +
                                                        '</span>' +
                                                    '</a>' +
                                                '</li>' +
                                                '<li>' +
                                                    '<a href="'+row.urls.eliminar+'" class="tooltip-error" data-rel="tooltip" title="" data-original-title="Elimina">' +
                                                        '<span class="red">' +
                                                            '<i class="ace-icon fa fa-trash-o bigger-120"></i>' +
                                                        '</span>' +
                                                    '</a>' +
                                                '</li>' +
                                            '</ul>' +
                                        '</div>' +
                                    '</div>'
                            }
                    },
                    { "visible": false,  "targets": [ 3 ] },
                    { "visible": false,  "targets": [ 5 ] }
                ],
                "rowCallback": function( row, data ) {

                }
            });

            $('[data-rel="tooltip"]').tooltip({placement: tooltip_placement});

            function tooltip_placement(context, source) {
                var $source = $(source);
                var $parent = $source.closest('table')
                var off1 = $parent.offset();
                var w1 = $parent.width();

                var off2 = $source.offset();
                //var w2 = $source.width();

                if( parseInt(off2.left) < parseInt(off1.left) + parseInt(w1 / 2) ) return 'right';
                return 'left';
            }

        })
    </script>
{% endblock extra_js %}