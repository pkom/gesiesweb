{% extends 'base.html' %}

{% load staticfiles %}
{% load thumbnail %}

{% block extra_css %}
<style>
    #partes-responsable>tbody>tr>td { vertical-align: middle; }
</style>
{% endblock extra_css %}


{% block breadcrumbs %}
  <!-- #section:basics/content.breadcrumbs -->
  <div class="breadcrumbs" id="breadcrumbs">
    <script type="text/javascript">
      try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
    </script>

    <ul class="breadcrumb">
      <li>
        <i class="ace-icon fa fa-bullhorn home-icon"></i>
        <a href="{% url 'parte:partes-responsable' %}">Partes del centro</a>
      </li>
      <li class="active">Partes del centro</li>
    </ul><!-- /.breadcrumb -->

    <!-- #section:basics/content.searchbox -->
    <div class="nav-search" id="nav-search">
      <form class="form-search">
        <span class="input-icon">
          <input type="text" placeholder="Buscar ..." class="nav-search-input" id="nav-search-input" autocomplete="off" />
          <i class="ace-icon fa fa-search nav-search-icon"></i>
        </span>
      </form>
    </div><!-- /.nav-search -->

    <!-- /section:basics/content.searchbox -->
  </div>
  <!-- /section:basics/content.breadcrumbs -->
{% endblock breadcrumbs %}



{% block pageheader %}
  <div class="page-header">
    <h1>
      Partes del Centro
      <small>
        <i class="ace-icon fa fa-angle-double-right"></i>
        Partes del Centro
      </small>
    </h1>
  </div><!-- /.page-header -->
{% endblock pageheader %}


{% block contenido %}
    <div class="table-header">
      <span class="badge badge-success">{{ total_partes }}</span>
      <span> Partes del centro</span>
      <span class="badge badge-important">Parte {{ total_partes_partes }}</span>
      <span class="badge badge-important">Comunicados {{ total_partes_comunicados }}</span>
      <span class="badge badge-important">Cerrados {{ total_partes_cerrados }}</span>
    </div>



<table id="partes-responsable" class="table table-striped table-bordered table-hover dataTable" aria-describedby="partes-responsable_info">
            <thead>
                <tr role="row">
                    <th class="hidden-480 sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Id: activate to sort column ascending">Id</th>
                    <th class="sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Fecha: activate to sort column ascending">Fecha</th>
                    <th class="sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Grupo: activate to sort column ascending">Grupo</th>
                    <th class="align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Foto Alumno: activate to sort column ascending">FotoA</th>
                    <th class="sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Alumno: activate to sort column ascending">Alumno</th>
                    <th class="align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Foto Profesor: activate to sort column ascending">FotoP</th>
                    <th class="sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Profesor: activate to sort column ascending">Profesor</th>
                    <th class="hidden-480 sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Parte: activate to sort column ascending">Parte</th>
                    <th class="hidden-480 sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Comunicado: activate to sort column ascending">Comun.</th>
                    <th class="hidden-480 sorting align-center" role="columnheader" tabindex="0" aria-controls="partes-responsable" rowspan="1" colspan="1" aria-label="Cerrado: activate to sort column ascending">Cerrado</th>
                    <th class="sorting_disabled align-center" role="columnheader" rowspan="1" colspan="1" aria-label="">Acciones</th>
                </tr>
            </thead>
            <tbody>

            </tbody>
</table>

{% endblock contenido %}

{% block extra_js_links %}
		<script src="{% static 'js/jquery.dataTables.min.js' %}"></script>
		<script src="{% static 'js/jquery.dataTables.bootstrap.min.js' %}"></script>
{% endblock extra_js_links %}

{% block extra_js %}
    <script type="text/javascript">
        jQuery(function($) {

            var oPartesResponsable =
            $('#partes-responsable').dataTable({
                "lengthMenu": [[ 5, 10, 15, -1 ], [ 5, 10, 15, "Todos" ]],
                "processing": true,
                "serverSide": true,
                "ajax": "{% url 'parte:partes_responsable_json' %}",

                "language": {
                    "url": "{% static 'js/dataTables.spanish.lang' %}"
                },
                "order": [[ 1, "desc" ], [ 0, "desc" ]],
                bAutoWidth: false,
                "aoColumns": [
                  null, null, null,
                  { "bSortable": false },
                  null,
                  { "bSortable": false },
                  null, null, null, null,
                  { "bSortable": false }
                ],
                "columnDefs": [
                    { "searchable": false, "targets": [ 0, 3, 5, 7, 8, 9, 10] },
                    { className: "hidden-480 align-right", "targets": [ 0 ] },
                    { className: "align-center", "targets": [ 1, 2, 10 ] },
                    { className: "hidden-480 align-center", "targets": [ 7, 8, 9 ] },
                    {
                        // The `data` parameter refers to the data for the cell (defined by the
                        // `data` option, which defaults to the column being worked with, in
                        // this case `data: 0`.
                        "render": function ( data, type, row ) {
                            return row[3] + data;
                        },
                        "targets": 4
                    },
                    {
                        // The `data` parameter refers to the data for the cell (defined by the
                        // `data` option, which defaults to the column being worked with, in
                        // this case `data: 0`.
                        "render": function ( data, type, row ) {
                            return row[5] + data;
                        },
                        "targets": 6
                    },
                    { "visible": false,  "targets": [ 3 ] },
                    { "visible": false,  "targets": [ 5 ] }
                ]
            });

            $(document).on('click', 'th input:checkbox' , function(){
                var that = this;
                $(this).closest('table').find('tr > td:first-child input:checkbox')
                .each(function(){
                    this.checked = that.checked;
                    $(this).closest('tr').toggleClass('selected');
                });
            });


            $('[data-rel="tooltip"]').tooltip({placement: tooltip_placement});
            function tooltip_placement(context, source) {
                var $source = $(source);
                var $parent = $source.closest('table')
                var off1 = $parent.offset();
                var w1 = $parent.width();

                var off2 = $source.offset();
                //var w2 = $source.width();

                if( parseInt(off2.left) < parseInt(off1.left) + parseInt(w1 / 2) ) return 'right';
                return 'left';
            }

        })
    </script>
{% endblock extra_js %}